<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../layouts/scaffold-layout.html">
<link rel="import" href="../elements/code-block.html">
<link rel="import" href="../elements/code-snippet.html">

<template>
  <scaffold-layout selected="home">
    <div class="title">Home</div>

    <h2>Router for Web Components</h2>
    <p>Works with <a href="http://www.polymer-project.org/">Polymer</a>, <a href="http://www.x-tags.org/">X-Tag</a>, and natively with the <a href="https://github.com/Polymer/platform">platform</a> polyfill.</p>
    <p>Lazy-loads content. Binds path variables and query parameters to the page element's attributes. Supports multiple layouts. Works with <code-snippet>hashchange</code-snippet> and HTML5 <code-snippet>pushState</code-snippet>. One set of routes will match regular paths <code-snippet>/</code-snippet> and hash paths <code-snippet>#/</code-snippet>.</p>

    <p><a href="https://github.com/erikringsmuth/app-router/archive/master.zip">Download</a> or run <code-snippet>bower install app-router --save</code-snippet></p>

    <h2>Configuration</h2>
<code-block>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;App Router&lt;/title&gt;
  &lt;link rel="import" href="/bower_components/app-router/app-router.html"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;app-router&gt;
    &lt;!-- matches an exact path --&gt;
    &lt;app-route path="/home" import="/pages/home-page.html"&gt;&lt;/app-route&gt;

    &lt;!-- matches using a wildcard --&gt;
    &lt;app-route path="/customer/*" import="/pages/customer-page.html"&gt;&lt;/app-route&gt;

    &lt;!-- matches using a path variable --&gt;
    &lt;app-route path="/order/:id" import="/pages/order-page.html"&gt;&lt;/app-route&gt;

    &lt;!-- matches a pattern like '/word/number' --&gt;
    &lt;app-route path="/^\/\w+\/\d+$/i" regex import="/pages/regex-page.html"&gt;&lt;/app-route&gt;

    &lt;!-- matches everything else --&gt;
    &lt;app-route path="*" import="/pages/not-found-page.html"&gt;&lt;/app-route&gt;
  &lt;/app-router&gt;
&lt;/body&gt;
&lt;/html&gt;</code-block>
    <p>Changing the URL will find the first <code-snippet>app-route</code-snippet> that matches, load the element or template, and replace the current view.</p>

    <h2>Data Binding</h2>
    <p>Path variables and query parameters automatically attach to the element's attributes.</p>

<code-block>&lt;!-- url --&gt;
http://www.example.com/order/123?sort=ascending

&lt;!-- route --&gt;
&lt;app-route path="/order/:id" import="/pages/order-page.html"&gt;&lt;/app-route&gt;

&lt;!-- will bind 123 to the page's `id` attribute and "ascending" to the `sort` attribute --&gt;
&lt;order-page id="123" sort="ascending"&gt;&lt;/order-page&gt;</code-block>

    <p>See it in action <a href="../#/databinding/1337?queryParam1=Routing%20with%20Web%20Components!">here</a>.</p>

    <h2>Navigation</h2>
    <p>There are three ways to trigger a route change. <code-snippet>hashchange</code-snippet>, <code-snippet>pushState()</code-snippet>, and a full page load.</p>
    <h4>hashchange</h4>
    <p>If you're using <code-snippet>hashchange</code-snippet> you don't need to do anything. Clicking a link <code-snippet>&lt;a href="/#/link"&gt;New Page&lt;/a&gt;</code-snippet> will fire a <code-snippet>hashchange</code-snippet> event and tell the router to load the new route. You don't need to handle the event in your Javascript.</p>
    <h4>pushState</h4>
    <p>You can use the <a href="https://github.com/erikringsmuth/html5-history-anchor">html5-history-anchor</a> to extend the <code-snippet>&lt;a&gt;</code-snippet> tag with the HTML5 history API.</p>
<code-block>&lt;a is="html5-history-anchor" href="/link" pushstate popstate&gt;/link&lt;/a&gt;</code-block>
    <p>Note: When you use HTML5 <code-snippet>pushState()</code-snippet> you have to manually fire a <code-snippet>popstate</code-snippet> event. The <code-snippet>pushState()</code-snippet> method was not meant to change the page, it was only meant to push state into history. This is an "undo" feature for single page applications. To use <code-snippet>pushState()</code-snippet> to navigate to another route you need to call it like this.</p>
<code-block>// push a new URL into the history stack
history.pushState(stateObj, title, '/link');
// fire a popstate event
window.dispatchEvent(new PopStateEvent('popstate', {
  bubbles: false,
  cancelable: false,
  state: history.state
}));</code-block>
    <p>The <a href="https://github.com/erikringsmuth/html5-history-anchor">html5-history-anchor</a> takes care of this for you as long as you include the <code-snippet>pushstate</code-snippet> and <code-snippet>popstate</code-snippet> attributes.</p>
    <h4>Full page load</h4>
    <p>Clicking a link <code-snippet>&lt;a href="/link"&gt;New Page&lt;/a&gt;</code-snippet> without a hash path will do a full page load. You need to make sure your server will return <code-snippet>index.html</code-snippet> when looking up the resource at <code-snippet>/link</code-snippet>. The simplest set up is to always return <code-snippet>index.html</code-snippet> and let the <code-snippet>app-router</code-snippet> handle the routing including a not found page.</p>

    <p>See the navigation examples here <a href="https://github.com/erikringsmuth/app-router-examples">app-router-examples</a>.</p>

  </scaffold-layout>
</template>
