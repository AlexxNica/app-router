<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../layouts/scaffold-layout.html">
<link rel="import" href="../elements/code-block.html">
<link rel="import" href="../elements/code-snippet.html">

<polymer-element name="notes-page" noscript>
  <template>
    <scaffold-layout selected="notes">
      <div class="title">Notes</div>

      <h2 id="breaking-changes">Breaking Changes <a href="#/notes#breaking-changes">#</a></h2>

      <p>Check the <a href="https://github.com/erikringsmuth/app-router/blob/master/changelog.md">change log</a> for breaking changes in major versions.</p>

      <h2 id="pushstate" class="top-spacing">pushState <a href="#/notes#pushstate">#</a></h2>

      <p>You can use the <a href="https://github.com/erikringsmuth/pushstate-anchor">pushstate-anchor</a> or <a href="https://github.com/erikringsmuth/html5-history-anchor">html5-history-anchor</a> to extend <code-snippet>&lt;a&gt;</code-snippet> tags with the HTML5 history API.</p>

<code-block>&lt;a is="pushstate-anchor" href="/home"&gt;Home&lt;/a&gt;</code-block>

      <p>When you use HTML5 <code-snippet>pushState()</code-snippet> you have to manually fire a <code-snippet>popstate</code-snippet> event. The <code-snippet>pushState()</code-snippet> method was not meant to change the page, it was only meant to push state into history. This is an "undo" feature for single page applications. To use <code-snippet>pushState()</code-snippet> to navigate to another route you need to call it like this.</p>

<code-block>// push a new URL into the history stack
history.pushState(stateObj, title, '/home');
// dispatch a popstate event
window.dispatchEvent(new PopStateEvent('popstate', {
  bubbles: false,
  cancelable: false,
  state: history.state
}));</code-block>

      <p>The <a href="https://github.com/erikringsmuth/pushstate-anchor">pushstate-anchor</a> takes care of this for you by calling <code-snippet>pushState()</code-snippet> and dispatching a <code-snippet>popstate</code-snippet> event.</p>

      <h2 id="cordova" class="top-spacing">Cordova compatibility <a href="#/notes#cordova">#</a></h2>

      <p>There are a couple things to be aware of when using app-router with <a href="http://cordova.apache.org/">Cordova</a>. iOS, Android, and Windows Phone all load files from different locations using the <code-snippet>file://</code-snippet> protocol but they all follow this pattern when loading the first page <code-snippet>file://**/www/index.html</code-snippet>.</p>

      <p>You can set up your routes like this to load the first page.</p>

<code-block>&lt;app-router&gt;
  &lt;app-route path="/" import="pages/home-page.html"&gt;&lt;/app-route&gt;
  &lt;app-route path="/**/www/index.html" import="pages/home-page.html"&gt;&lt;/app-route&gt;
  &lt;app-route path="*" import="pages/not-found.html"&gt;&lt;/app-route&gt;
&lt;/app-router&gt;</code-block>

      <p>You need to use relative paths since the files are in different locations in iOS, Android, and Windows Phone. Do this by removing the leading slash from the <code-snippet>import</code-snippet> attributes. You will also have to switch everything else in your app to use relative paths.</p>

    </scaffold-layout>
  </template>
</polymer-element>
