<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../layouts/scaffold-layout.html">
<link rel="import" href="../elements/code-block.html">
<link rel="import" href="../elements/code-snippet.html">

<polymer-element name="api-page" noscript>
  <template>
    <scaffold-layout selected="api">
      <div class="title">API</div>

      <h2>&lt;app-router&gt;</h2>

      <h4>Trailing Slashes</h4>
      <p>By default <code-snippet>/home</code-snippet> and <code-snippet>/home/</code-snippet> are treated as separate routes. You can configure the router to ignore trailing slashes with <code-snippet>trailingSlash="ignore"</code-snippet>.</p>
<code-block>&lt;app-router trailingSlash="ignore"&gt;
  &lt;!-- matches '/home' and '/home/' --&gt;
  &lt;app-route path="/home" import="/pages/home-page.html"&gt;&lt;/app-route&gt;
&lt;/app-router&gt;</code-block>

      <h4>Shadow DOM</h4>
      <p>The router puts the active route's content in an <code-snippet>&lt;active-route&gt;&lt;/active-route&gt;</code-snippet> element.</p>
<code-block>&lt;app-router&gt;
  &lt;!-- app-routes --&gt;
  &lt;active-route&gt;&lt;!-- active route content --&gt;&lt;/active-route&gt;
&lt;/app-router&gt;</code-block>

      <p>If you want the active route's content isolated in a shadow tree you can add the <code-snippet>shadow</code-snippet> attribute like this.</p>
<code-block>&lt;app-router shadow&gt;
  &lt;!-- app-routes --&gt;
  &lt;active-route&gt;
    # shadow-root &lt;!-- the active route's content will be inside the shadow root --&gt;
  &lt;/active-route&gt;
&lt;/app-router&gt;</code-block>

      <h4>init</h4>
      <p>The router initializes itself when attached to the DOM. You can defer initialization by setting <code-snippet>init="manual"</code-snippet> and calling <code-snippet>init()</code-snippet> later.</p>
<code-block>&lt;app-router init="manual"&gt;
  &lt;!-- app-routes --&gt;
&lt;/app-router&gt;
&lt;script&gt;
  document.querySelector('app-router').init();
&lt;/script&gt;</code-block>

      <h2>&lt;app-route&gt;</h2>

      <h4>import a custom element</h4>
      <p>Lazy-load a custom element.</p>
<code-block>&lt;app-route path="/customer/:customerId" import="/pages/customer-page.html"&gt;&lt;/app-route&gt;</code-block>
      <p>When you navigate to <code-snippet>/customer/123</code-snippet> the router will load <code-snippet>/pages/customer-page.html</code-snippet>, replace the active view with a new <code-snippet>customer-page</code-snippet> element, and bind any attributes <code-snippet>element.setAttribute('customerId', 123)</code-snippet>.</p>
      <p>You can manually set the element's name with the <code-snippet>element</code-snippet> attribute if it's different from the file name. This is useful when bundling (vulcanizing) custom elements.</p>
<code-block>&lt;app-route path="/customer/:customerId" import="/pages/page-bundle.html" element="customer-page"&gt;&lt;/app-route&gt;</code-block>

      <h4>pre-loaded custom element</h4>
      <p>You can route to a pre-loaded custom element. In this case, load the element normally in the <code-snippet>&lt;head&gt;</code-snippet> and include the <code-snippet>element="element-name"</code-snippet> attribute on the route. This is how you'd bundle and pre-load custom elements.</p>
<code-block>&lt;head&gt;
  &lt;link rel="import" href="/pages/page-bundle.html"&gt;
&lt;/head&gt;
&lt;app-router&gt;
  &lt;app-route path="/customer/:customerId" element="customer-page"&gt;&lt;/app-route&gt;
&lt;/app-router&gt;</code-block>

      <h4>import template</h4>
      <p>You can use a <code-snippet>&lt;template&gt;</code-snippet> instead of a custom element. This doesn't have data binding and is lighter-weight than a custom element. Just include the <code-snippet>template</code-snippet> attribute.</p>
<code-block>&lt;app-route path="/example" import="/pages/template-page.html" template&gt;&lt;/app-route&gt;</code-block>

      <h4>inline template</h4>
      <p>Finally, you can in-line a <code-snippet>&lt;template&gt;</code-snippet> like this.</p>
<code-block>&lt;app-route path="/example" template&gt;
  &lt;template&gt;
    &lt;p&gt;Inline template FTW!&lt;/p&gt;
  &lt;/template&gt;
&lt;/app-route&gt;</code-block>

      <h4>regular expressions</h4>
      <p>Include the <code-snippet>regex</code-snippet> attribute to match on a regular expression. The format is the same as a JavaScript regular expression.</p>
<code-block>&lt;!-- matches a pattern like '/word/number' --&gt;
&lt;app-route path="/^\/\w+\/\d+$/i" regex import="/pages/regex-page.html"&gt;&lt;/app-route&gt;</code-block>
      <p>Note: The regular expression must start with a <code-snippet>/</code-snippet> and end with a <code-snippet>/</code-snippet> optionally followed by <code-snippet>i</code-snippet>. Options global <code-snippet>g</code-snippet>, multiline <code-snippet>m</code-snippet>, and sticky <code-snippet>y</code-snippet> aren't valid when matching paths.</p>

      <h2>lifecycle events</h2>
      <p>Lifecycle events let you hook into different stages of the route process. If you're listening to events you should manually initialize the router to ensure your event listeners are attached before the first route loads. You can attach event listeners to the router or specific routes.</p>
<code-block>&lt;app-router init="manual"&gt;
  &lt;!-- app-routes --&gt;
&lt;/app-router&gt;
&lt;script&gt;
  var router = document.querySelector('app-router');
  router.addEventListener('state-change', function(event) {
    event.type; // 'state-change'
    event.detail.path; // parsed URL path
    event.preventDefault(); // cancel the new route
  });
  router.init();
&lt;/script&gt;</code-block>

      <h4>state-change (app-router)</h4>
      <p><code-snippet>state-change</code-snippet> is fired when the URL changes. This is triggered by a <code-snippet>hashchange</code-snippet>,  <code-snippet>popstate</code-snippet>, or full page load.</p>
<code-block>// event.detail
{
  path: '/new-path'
}</code-block>

      <h4>not-found (app-router)</h4>
      <p><code-snippet>not-found</code-snippet> is fired after a <code-snippet>state-change</code-snippet> if no matching route is found.</p>
<code-block>// event.detail
{
  path: '/new-path'
}</code-block>

      <h4>activate-route-start (app-router, app-route)</h4>
      <p><code-snippet>activate-route-start</code-snippet> is fired on both the router and the matching route before the route is loaded.</p>
<code-block>// event.detail
{
  path: '/new-path',
  route: newRoute,
  oldRoute: oldRoute
}</code-block>

      <h4>activate-route-end (app-router, app-route)</h4>
      <p><code-snippet>activate-route-end</code-snippet> is fired on both the router and the matching route after the route has been changed.</p>
<code-block>// event.detail
{
  path: '/new-path',
  route: newRoute,
  oldRoute: oldRoute
}</code-block>

    </scaffold-layout>
  </template>
</polymer-element>
